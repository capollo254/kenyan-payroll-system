{"ast":null,"code":"// src/pages/admin/EmployeeManagementPage.js\nimport React,{useEffect,useState}from'react';import{getEmployees,deleteEmployee}from'../../api/employees';import{useNavigate}from'react-router-dom';import AddEmployeeForm from'../../components/forms/AddEmployeeForm';import Button from'../../components/common/Button';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EmployeeManagementPage=()=>{const[employees,setEmployees]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[isAdding,setIsAdding]=useState(false);const navigate=useNavigate();const fetchEmployees=async()=>{setLoading(true);setError(null);try{const data=await getEmployees();setEmployees(data);}catch(err){console.error('Failed to fetch employees:',err);if(err.response&&err.response.status===401){localStorage.removeItem('token');localStorage.removeItem('role');navigate('/login');}setError('Could not load employee data.');}finally{setLoading(false);}};useEffect(()=>{fetchEmployees();},[]);const handleDelete=async employeeId=>{if(window.confirm(\"Are you sure you want to delete this employee?\")){try{await deleteEmployee(employeeId);fetchEmployees();// Refresh the list\n}catch(err){console.error('Failed to delete employee:',err);setError('Failed to delete employee.');}}};const handleEmployeeAdded=()=>{setIsAdding(false);fetchEmployees();// Refresh the list after adding a new employee\n};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"container page\",children:\"Loading employees...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"container page error\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Employee Management\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'20px'},children:!isAdding&&/*#__PURE__*/_jsx(Button,{className:\"btn-success\",onClick:()=>setIsAdding(true),children:\"Add New Employee\"})}),isAdding?/*#__PURE__*/_jsx(AddEmployeeForm,{onEmployeeAdded:handleEmployeeAdded,onCancel:()=>setIsAdding(false)}):/*#__PURE__*/_jsx(\"div\",{style:{overflowX:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:employees.map(employee=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:employee.id}),/*#__PURE__*/_jsx(\"td\",{children:employee.full_name}),/*#__PURE__*/_jsx(\"td\",{children:employee.user.email}),/*#__PURE__*/_jsx(\"td\",{children:employee.is_admin?'Admin':'Employee'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(employee.id),style:{color:'red',border:'none',background:'none',cursor:'pointer'},children:\"Delete\"})})]},employee.id))})]})})]});};export default EmployeeManagementPage;","map":{"version":3,"names":["React","useEffect","useState","getEmployees","deleteEmployee","useNavigate","AddEmployeeForm","Button","jsx","_jsx","jsxs","_jsxs","EmployeeManagementPage","employees","setEmployees","loading","setLoading","error","setError","isAdding","setIsAdding","navigate","fetchEmployees","data","err","console","response","status","localStorage","removeItem","handleDelete","employeeId","window","confirm","handleEmployeeAdded","className","children","style","marginBottom","onClick","onEmployeeAdded","onCancel","overflowX","map","employee","id","full_name","user","email","is_admin","color","border","background","cursor"],"sources":["C:/Users/Code_AI/Documents/Bloom HR and Payroll/kenyan-payroll-system/frontend/src/pages/admin/EmployeeManagementPage.js"],"sourcesContent":["// src/pages/admin/EmployeeManagementPage.js\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { getEmployees, deleteEmployee } from '../../api/employees';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport AddEmployeeForm from '../../components/forms/AddEmployeeForm';\r\nimport Button from '../../components/common/Button';\r\n\r\nconst EmployeeManagementPage = () => {\r\n  const [employees, setEmployees] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isAdding, setIsAdding] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  const fetchEmployees = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const data = await getEmployees();\r\n      setEmployees(data);\r\n    } catch (err) {\r\n      console.error('Failed to fetch employees:', err);\r\n      if (err.response && err.response.status === 401) {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('role');\r\n        navigate('/login');\r\n      }\r\n      setError('Could not load employee data.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchEmployees();\r\n  }, []);\r\n\r\n  const handleDelete = async (employeeId) => {\r\n    if (window.confirm(\"Are you sure you want to delete this employee?\")) {\r\n      try {\r\n        await deleteEmployee(employeeId);\r\n        fetchEmployees(); // Refresh the list\r\n      } catch (err) {\r\n        console.error('Failed to delete employee:', err);\r\n        setError('Failed to delete employee.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleEmployeeAdded = () => {\r\n    setIsAdding(false);\r\n    fetchEmployees(); // Refresh the list after adding a new employee\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"container page\">Loading employees...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"container page error\">{error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container page\">\r\n      <h2>Employee Management</h2>\r\n      <div style={{ marginBottom: '20px' }}>\r\n        {!isAdding && <Button className=\"btn-success\" onClick={() => setIsAdding(true)}>Add New Employee</Button>}\r\n      </div>\r\n\r\n      {isAdding ? (\r\n        <AddEmployeeForm onEmployeeAdded={handleEmployeeAdded} onCancel={() => setIsAdding(false)} />\r\n      ) : (\r\n        <div style={{ overflowX: 'auto' }}>\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>ID</th>\r\n                <th>Name</th>\r\n                <th>Email</th>\r\n                <th>Role</th>\r\n                <th>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {employees.map(employee => (\r\n                <tr key={employee.id}>\r\n                  <td>{employee.id}</td>\r\n                  <td>{employee.full_name}</td>\r\n                  <td>{employee.user.email}</td>\r\n                  <td>{employee.is_admin ? 'Admin' : 'Employee'}</td>\r\n                  <td>\r\n                    <button onClick={() => handleDelete(employee.id)} style={{ color: 'red', border: 'none', background: 'none', cursor: 'pointer' }}>\r\n                      Delete\r\n                    </button>\r\n                    {/* An \"Edit\" button could be added here */}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EmployeeManagementPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}